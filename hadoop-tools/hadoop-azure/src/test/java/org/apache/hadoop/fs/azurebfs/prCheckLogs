2022-11-08 22:53:49,949 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetAcl
2022-11-08 22:53:49,991 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:51,636 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetAcl: 404,,,cid=:db91af7d-ab3f-49fc-a7ef-ecc1c802566b:e06a785f-2dfd-4da4-849a-db496a220182:::CF:0,rid=a4fb81bc-101f-0004-7508-f4808b000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/?upn=false&action=getAccessControl&timeout=90
2022-11-08 22:53:51,640 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - CreateFileSystem
2022-11-08 22:53:51,640 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:51,913 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: CreateFileSystem: 201,,,cid=:884eff5b-c1e4-49cc-a5a8-25b62382b2f9:e06a785f-2dfd-4da4-849a-db496a220182:::CF:0,rid=a4fb81db-101f-0004-1408-f4808b000000,sent=0,recv=0,PUT,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812?resource=filesystem
2022-11-08 22:53:51,930 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetAcl
2022-11-08 22:53:51,930 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:52,185 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetAcl: 200,,,cid=:faf99df8-b348-46fd-bf01-54487c1ebe3e:e06a785f-2dfd-4da4-849a-db496a220182:::TS:0,rid=a4fb81f9-101f-0004-3208-f4808b000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/?upn=false&action=getAccessControl&timeout=90
2022-11-08 22:53:52,237 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - CreatePath
2022-11-08 22:53:52,237 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:52,512 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: CreatePath: 201,,,cid=:25a134d1-d17c-4bc9-9676-2f2dddcda7d5:e06a785f-2dfd-4da4-849a-db496a220182:2f9bf410-d3d1-4012-8a6b-b73ee8675059::CR:0,rid=a4fb821a-101f-0004-5308-f4808b000000,sent=0,recv=0,PUT,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?resource=file&timeout=90
2022-11-08 22:53:52,556 DEBUG [abfs-bounded-pool1-t1]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - Append
2022-11-08 22:53:52,557 DEBUG [abfs-bounded-pool1-t1]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:52,558 DEBUG [abfs-bounded-pool1-t3]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - Append
2022-11-08 22:53:52,558 DEBUG [abfs-bounded-pool1-t3]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:52,561 DEBUG [abfs-bounded-pool1-t4]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - Append
2022-11-08 22:53:52,561 DEBUG [abfs-bounded-pool1-t4]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:52,564 DEBUG [abfs-bounded-pool1-t2]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - Append
2022-11-08 22:53:52,564 DEBUG [abfs-bounded-pool1-t2]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:55,125 DEBUG [abfs-bounded-pool1-t1]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: Append: 202,,,cid=:81f564b2-facb-477d-bceb-6bfa3eae3331:e06a785f-2dfd-4da4-849a-db496a220182:2f9bf410-d3d1-4012-8a6b-b73ee8675059:84db8c46e19e:WR:0,rid=a4fb823c-101f-0004-7508-f4808b000000,sent=4194304,recv=0,PUT,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?action=append&position=0&timeout=90
2022-11-08 22:53:55,737 DEBUG [abfs-bounded-pool1-t2]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: Append: 202,,,cid=:a65e8fee-4e95-4a8b-831f-530b3eff7c4d:e06a785f-2dfd-4da4-849a-db496a220182:2f9bf410-d3d1-4012-8a6b-b73ee8675059:84db8c46e19e:WR:0,rid=d54e7ed4-201f-001f-0708-f4be88000000,sent=4194304,recv=0,PUT,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?action=append&position=4194304&timeout=90
2022-11-08 22:53:55,766 DEBUG [abfs-bounded-pool1-t4]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: Append: 202,,,cid=:d95d4166-ec50-426b-b70d-b2c19606dd14:e06a785f-2dfd-4da4-849a-db496a220182:2f9bf410-d3d1-4012-8a6b-b73ee8675059:84db8c46e19e:WR:0,rid=a06bf5bc-e01f-00e4-2108-f40312000000,sent=4194304,recv=0,PUT,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?action=append&position=12582912&timeout=90
2022-11-08 22:53:55,834 DEBUG [abfs-bounded-pool1-t3]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: Append: 202,,,cid=:6ec88d11-a8eb-48d9-bf55-635effade18b:e06a785f-2dfd-4da4-849a-db496a220182:2f9bf410-d3d1-4012-8a6b-b73ee8675059:84db8c46e19e:WR:0,rid=3d6cd1f2-a01f-00ca-3c08-f45105000000,sent=4194304,recv=0,PUT,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?action=append&position=8388608&timeout=90
2022-11-08 22:53:55,838 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - Flush
2022-11-08 22:53:55,839 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:56,117 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: Flush: 200,,,cid=:5c6f5eef-aa5f-4870-be19-9d7db8d91d25:e06a785f-2dfd-4da4-849a-db496a220182:2f9bf410-d3d1-4012-8a6b-b73ee8675059:84db8c46e19e:WR:0,rid=3d6cd2ab-a01f-00ca-7408-f45105000000,sent=0,recv=0,PUT,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?action=flush&retainUncommittedData=false&position=16777216&close=true&timeout=90
2022-11-08 22:53:56,122 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:56,123 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:56,376 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:06f6899c-b2db-4a54-8d50-4cc1453eb72b:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd2bd-a01f-00ca-0608-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:56,383 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:56,386 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:56,387 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:56,638 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:50a336ab-949f-4980-99c9-aa5ef56bbf63:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd2ce-a01f-00ca-1708-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:56,638 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:56,639 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:56,639 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:56,892 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:8680bb96-7133-4031-9dc3-4fe1c28d115e:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd2e0-a01f-00ca-2908-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:56,893 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:56,893 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:56,893 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:57,144 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:41bc0b10-c9cd-446c-b9d4-fb832f35426c:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd2f8-a01f-00ca-4008-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:57,144 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:57,145 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:57,145 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:57,396 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:ad99249d-4cb9-4e1e-b61d-30e3917a627b:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd311-a01f-00ca-5908-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:57,396 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:57,397 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:57,397 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:57,646 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:f6269449-e23d-4124-9193-f0bf87e18e2f:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd330-a01f-00ca-7708-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:57,646 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:57,646 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:57,646 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:57,896 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:34a2d3dd-ab3c-432f-aabf-3677ba2807ec:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd34c-a01f-00ca-1208-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:57,896 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:57,897 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:57,897 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,146 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:46d0962e-0a0a-4d39-b0ce-9c5a0c653b5f:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd369-a01f-00ca-2f08-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:58,146 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:58,147 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:58,147 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,398 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:9fcc122c-544c-46d5-989f-11f6d449da69:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd38b-a01f-00ca-5108-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:58,398 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:58,398 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetPathStatus
2022-11-08 22:53:58,399 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,647 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetPathStatus: 200,,,cid=:c3ca6893-e4a3-4bb9-8595-766d624fb77c:e06a785f-2dfd-4da4-849a-db496a220182:::OP:0,rid=3d6cd3ad-a01f-00ca-7308-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?upn=false&action=getStatus&timeout=90
2022-11-08 22:53:58,647 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:setReadBufferManagerConfigs(103)) - ReadBufferManager not initialized yet. Overriding readAheadBlockSize as 4194304
2022-11-08 22:53:58,701 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 0 length 4194304
2022-11-08 22:53:58,702 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 0 buffer idx 15
2022-11-08 22:53:58,702 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 4194304 length 4194304
2022-11-08 22:53:58,702 TRACE [ABFS-prefetch-5]: services.ReadBufferManager (ReadBufferManager.java:getNextBlockToRead(575)) - ReadBufferWorker picked file /testfile6170ae9e6de4 for offset 0
2022-11-08 22:53:58,702 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 4194304 buffer idx 14
2022-11-08 22:53:58,704 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:getBlock(200)) - getBlock for file /testfile6170ae9e6de4  position 0  thread JUnit-purgeIssue
2022-11-08 22:53:58,704 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:waitForProcess(237)) - got a relevant read buffer for file /testfile6170ae9e6de4 offset 0 buffer idx 15
2022-11-08 22:53:58,704 TRACE [ABFS-prefetch-2]: services.ReadBufferManager (ReadBufferManager.java:getNextBlockToRead(575)) - ReadBufferWorker picked file /testfile6170ae9e6de4 for offset 4194304
2022-11-08 22:53:58,710 DEBUG [ABFS-prefetch-2]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,710 DEBUG [ABFS-prefetch-5]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,710 DEBUG [ABFS-prefetch-5]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,711 DEBUG [ABFS-prefetch-2]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,711 DEBUG [ABFS-prefetch-5]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:eb0e50b2-46b0-48a6-a468-5dee4b1cdeb5:e06a785f-2dfd-4da4-849a-db496a220182:5cb03bf5-c32e-4649-9443-feb095a0bc60:1dd2ce921237:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,711 DEBUG [ABFS-prefetch-2]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:efd35921-74dc-4e94-a1e4-d7a702d3d9dd:e06a785f-2dfd-4da4-849a-db496a220182:5cb03bf5-c32e-4649-9443-feb095a0bc60:1dd2ce921237:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,712 TRACE [ABFS-prefetch-5]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 0 bytes 0
2022-11-08 22:53:58,712 TRACE [ABFS-prefetch-2]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 4194304 bytes 0
2022-11-08 22:53:58,719 DEBUG [ABFS-prefetch-5]: services.ReadBufferManager (ReadBufferManager.java:placeBufferOnFreeList(406)) - Returning buffer index 15 to free list for 'failed read'; owner ReadBuffer{status=READING_IN_PROGRESS, offset=0, length=0, requestedLength=4194304, bufferindex=15, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=null, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@2c2e0e26{counters=((remote_bytes_read=0) (stream_read_seek_forward_operations=1) (stream_read_bytes=0) (stream_read_seek_bytes_skipped=0) (stream_read_bytes_backwards_on_seek=0) (bytes_read_buffer=0) (stream_read_operations=1) (stream_read_seek_backward_operations=0) (action_http_get_request.failures=0) (read_ahead_bytes_read=0) (action_http_get_request=0) (stream_read_seek_operations=1) (seek_in_buffer=0) (remote_read_op=2));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(741215782){StreamStatistics{counters=((read_ahead_bytes_read=0) (stream_read_seek_backward_operations=0) (stream_read_operations=1) (stream_read_seek_forward_operations=1) (bytes_read_buffer=0) (seek_in_buffer=0) (action_http_get_request=0) (stream_read_seek_bytes_skipped=0) (action_http_get_request.failures=0) (stream_read_seek_operations=1) (remote_bytes_read=0) (stream_read_bytes=0) (stream_read_bytes_backwards_on_seek=0) (remote_read_op=2));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}}}
2022-11-08 22:53:58,720 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:waitForProcess(251)) - latch done for file /testfile6170ae9e6de4 buffer idx 15 length 0
2022-11-08 22:53:58,720 TRACE [ABFS-prefetch-5]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 0 bytes 0
2022-11-08 22:53:58,724 DEBUG [ABFS-prefetch-2]: services.ReadBufferManager (ReadBufferManager.java:placeBufferOnFreeList(406)) - Returning buffer index 14 to free list for 'failed read'; owner ReadBuffer{status=READING_IN_PROGRESS, offset=4194304, length=0, requestedLength=4194304, bufferindex=14, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=null, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@2c2e0e26{counters=((stream_read_seek_bytes_skipped=0) (stream_read_seek_backward_operations=0) (action_http_get_request=0) (read_ahead_bytes_read=0) (action_http_get_request.failures=0) (bytes_read_buffer=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_forward_operations=1) (stream_read_bytes=0) (seek_in_buffer=0) (stream_read_operations=1) (stream_read_seek_operations=1) (remote_bytes_read=0) (remote_read_op=2));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(741215782){StreamStatistics{counters=((stream_read_seek_backward_operations=0) (stream_read_operations=1) (seek_in_buffer=0) (remote_bytes_read=0) (stream_read_bytes_backwards_on_seek=0) (remote_read_op=2) (stream_read_seek_bytes_skipped=0) (stream_read_seek_forward_operations=1) (action_http_get_request.failures=0) (read_ahead_bytes_read=0) (bytes_read_buffer=0) (action_http_get_request=0) (stream_read_seek_operations=1) (stream_read_bytes=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}}}
2022-11-08 22:53:58,724 TRACE [ABFS-prefetch-2]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 4194304 bytes 0
Exception in thread "ABFS-prefetch-5" java.lang.IllegalStateException: Read completed from an operation not declared as in progress ReadBuffer{status=AVAILABLE, offset=0, length=0, requestedLength=4194304, bufferindex=15, timeStamp=46329430, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=org.apache.hadoop.fs.PathIOException: `/testfile6170ae9e6de4': Input/output error: Buffer index 15 found in buffer collection completedReadList, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@2c2e0e26{counters=((remote_bytes_read=0) (remote_read_op=2) (stream_read_operations=1) (action_http_get_request.failures=0) (stream_read_seek_backward_operations=0) (action_http_get_request=0) (stream_read_seek_bytes_skipped=0) (bytes_read_buffer=0) (stream_read_bytes=0) (seek_in_buffer=0) (stream_read_seek_forward_operations=1) (stream_read_seek_operations=1) (stream_read_bytes_backwards_on_seek=0) (read_ahead_bytes_read=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(741215782){StreamStatistics{counters=((stream_read_seek_backward_operations=0) (stream_read_bytes=0) (seek_in_buffer=0) (bytes_read_buffer=0) (stream_read_seek_bytes_skipped=0) (remote_read_op=2) (stream_read_operations=1) (remote_bytes_read=0) (stream_read_seek_forward_operations=1) (stream_read_seek_operations=1) (stream_read_bytes_backwards_on_seek=0) (action_http_get_request=0) (read_ahead_bytes_read=0) (action_http_get_request.failures=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}}}
	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
2022-11-08 22:53:58,725 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.doneReading(ReadBufferManager.java:596)
2022-11-08 22:53:58,725 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferWorker.run(ReadBufferWorker.java:89)
	at java.lang.Thread.run(Thread.java:750)
2022-11-08 22:53:58,726 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:acb1fa04-4176-4db6-b677-a854d4abe114:e06a785f-2dfd-4da4-849a-db496a220182::1dd2ce921237:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,726 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 0 length 4194304
Exception in thread "ABFS-prefetch-2" java.lang.IllegalStateException: Read completed from an operation not declared as in progress ReadBuffer{status=READING_IN_PROGRESS, offset=4194304, length=0, requestedLength=4194304, bufferindex=14, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=org.apache.hadoop.fs.PathIOException: `/testfile6170ae9e6de4': Input/output error: Buffer index 15 found in buffer collection completedReadList, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@2c2e0e26{counters=((stream_read_bytes=0) (remote_bytes_read=0) (bytes_read_buffer=0) (stream_read_seek_operations=1) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_backward_operations=0) (seek_in_buffer=0) (read_ahead_bytes_read=0) (stream_read_operations=1) (stream_read_seek_bytes_skipped=0) (action_http_get_request=0) (remote_read_op=3) (stream_read_seek_forward_operations=1) (action_http_get_request.failures=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(741215782){StreamStatistics{counters=((action_http_get_request=0) (seek_in_buffer=0) (read_ahead_bytes_read=0) (stream_read_bytes=0) (stream_read_seek_forward_operations=2) (stream_read_operations=1) (stream_read_bytes_backwards_on_seek=0) (remote_read_op=3) (remote_bytes_read=0) (bytes_read_buffer=0) (stream_read_seek_backward_operations=0) (stream_read_seek_operations=2) (stream_read_seek_bytes_skipped=0) (action_http_get_request.failures=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}}}
	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.doneReading(ReadBufferManager.java:596)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferWorker.run(ReadBufferWorker.java:89)
	at java.lang.Thread.run(Thread.java:750)
2022-11-08 22:53:58,727 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 0 buffer idx 14
2022-11-08 22:53:58,728 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 4194304 length 4194304
2022-11-08 22:53:58,728 TRACE [ABFS-prefetch-3]: services.ReadBufferManager (ReadBufferManager.java:getNextBlockToRead(575)) - ReadBufferWorker picked file /testfile6170ae9e6de4 for offset 0
2022-11-08 22:53:58,728 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 4194304 buffer idx 15
2022-11-08 22:53:58,728 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:getBlock(200)) - getBlock for file /testfile6170ae9e6de4  position 0  thread JUnit-purgeIssue
2022-11-08 22:53:58,728 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:waitForProcess(237)) - got a relevant read buffer for file /testfile6170ae9e6de4 offset 0 buffer idx 14
2022-11-08 22:53:58,728 TRACE [ABFS-prefetch-1]: services.ReadBufferManager (ReadBufferManager.java:getNextBlockToRead(575)) - ReadBufferWorker picked file /testfile6170ae9e6de4 for offset 4194304
2022-11-08 22:53:58,729 DEBUG [ABFS-prefetch-3]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,729 DEBUG [ABFS-prefetch-3]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,729 DEBUG [ABFS-prefetch-3]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:36d67c7f-ff2d-4bd3-b383-0741cd706c52:e06a785f-2dfd-4da4-849a-db496a220182:c3eb6375-3333-4ea2-a182-d80a245a45a5:dc4c1314d5ac:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,729 TRACE [ABFS-prefetch-3]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 0 bytes 0
2022-11-08 22:53:58,733 DEBUG [ABFS-prefetch-3]: services.ReadBufferManager (ReadBufferManager.java:placeBufferOnFreeList(406)) - Returning buffer index 14 to free list for 'failed read'; owner ReadBuffer{status=READING_IN_PROGRESS, offset=0, length=0, requestedLength=4194304, bufferindex=14, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=null, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@368988de{counters=((stream_read_seek_forward_operations=1) (stream_read_seek_bytes_skipped=0) (stream_read_seek_operations=1) (remote_bytes_read=0) (stream_read_bytes=0) (read_ahead_bytes_read=0) (bytes_read_buffer=0) (stream_read_seek_backward_operations=0) (seek_in_buffer=0) (remote_read_op=1) (action_http_get_request.failures=0) (action_http_get_request=0) (stream_read_operations=1) (stream_read_bytes_backwards_on_seek=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(914983134){StreamStatistics{counters=((stream_read_seek_backward_operations=0) (stream_read_seek_operations=1) (read_ahead_bytes_read=0) (remote_read_op=1) (action_http_get_request=0) (stream_read_seek_forward_operations=1) (action_http_get_request.failures=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_bytes=0) (seek_in_buffer=0) (stream_read_operations=1) (bytes_read_buffer=0) (stream_read_seek_bytes_skipped=0) (remote_bytes_read=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}}}
Exception in thread "ABFS-prefetch-3" java.lang.IllegalStateException: Read completed from an operation not declared as in progress ReadBuffer{status=AVAILABLE, offset=0, length=0, requestedLength=4194304, bufferindex=14, timeStamp=46329444, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=org.apache.hadoop.fs.PathIOException: `/testfile6170ae9e6de4': Input/output error: Buffer index 14 found in buffer collection completedReadList, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@368988de{counters=((stream_read_operations=1) (bytes_read_buffer=0) (action_http_get_request=0) (stream_read_seek_forward_operations=1) (stream_read_bytes=0) (seek_in_buffer=0) (stream_read_seek_backward_operations=0) (remote_bytes_read=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_bytes_skipped=0) (remote_read_op=1) (stream_read_seek_operations=1) (read_ahead_bytes_read=0) (action_http_get_request.failures=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(914983134){StreamStatistics{counters=((stream_read_bytes=0) (stream_read_seek_bytes_skipped=0) (stream_read_seek_operations=1) (remote_read_op=1) (stream_read_operations=1) (remote_bytes_read=0) (read_ahead_bytes_read=0) (stream_read_seek_forward_operations=1) (action_http_get_request=0) (seek_in_buffer=0) (stream_read_seek_backward_operations=0) (action_http_get_request.failures=0) (bytes_read_buffer=0) (stream_read_bytes_backwards_on_seek=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}}}
	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.doneReading(ReadBufferManager.java:596)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferWorker.run(ReadBufferWorker.java:89)
	at java.lang.Thread.run(Thread.java:750)
Exception in thread "ABFS-prefetch-1" java.lang.IllegalStateException: Buffer index 14 found in buffer collection completedReadList
	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.verifyByteBufferNotInCollection(ReadBufferManager.java:470)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.verifyByteBufferNotInUse(ReadBufferManager.java:456)
	at java.util.Vector.forEach(Vector.java:1277)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.validateReadManagerState(ReadBufferManager.java:495)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.getNextBlockToRead(ReadBufferManager.java:578)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferWorker.run(ReadBufferWorker.java:64)
	at java.lang.Thread.run(Thread.java:750)
2022-11-08 22:53:58,734 TRACE [ABFS-prefetch-3]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 0 bytes 0
2022-11-08 22:53:58,735 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:waitForProcess(251)) - latch done for file /testfile6170ae9e6de4 buffer idx 14 length 0
2022-11-08 22:53:58,736 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,736 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,737 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:5955b385-38e9-4a08-afa6-da24e879b92b:e06a785f-2dfd-4da4-849a-db496a220182::dc4c1314d5ac:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,737 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 0 length 4194304
2022-11-08 22:53:58,737 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 0 buffer idx 14
2022-11-08 22:53:58,737 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 4194304 length 4194304
2022-11-08 22:53:58,737 TRACE [ABFS-prefetch-4]: services.ReadBufferManager (ReadBufferManager.java:getNextBlockToRead(575)) - ReadBufferWorker picked file /testfile6170ae9e6de4 for offset 0
2022-11-08 22:53:58,737 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 4194304 buffer idx 13
2022-11-08 22:53:58,737 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:getBlock(200)) - getBlock for file /testfile6170ae9e6de4  position 0  thread JUnit-purgeIssue
2022-11-08 22:53:58,737 TRACE [ABFS-prefetch-6]: services.ReadBufferManager (ReadBufferManager.java:getNextBlockToRead(575)) - ReadBufferWorker picked file /testfile6170ae9e6de4 for offset 4194304
2022-11-08 22:53:58,738 DEBUG [ABFS-prefetch-4]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,738 DEBUG [ABFS-prefetch-6]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,738 DEBUG [ABFS-prefetch-4]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,738 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:waitForProcess(237)) - got a relevant read buffer for file /testfile6170ae9e6de4 offset 0 buffer idx 14
2022-11-08 22:53:58,738 DEBUG [ABFS-prefetch-4]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:611076f7-76c4-47b4-9256-b46f3f494c2e:e06a785f-2dfd-4da4-849a-db496a220182:61e2852e-676b-4df9-8439-8035085a18f8:7cf4d583f881:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,738 DEBUG [ABFS-prefetch-6]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,738 TRACE [ABFS-prefetch-4]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 0 bytes 0
2022-11-08 22:53:58,738 DEBUG [ABFS-prefetch-6]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:5202cb9d-2713-4050-8924-fdd0d9b9de82:e06a785f-2dfd-4da4-849a-db496a220182:61e2852e-676b-4df9-8439-8035085a18f8:7cf4d583f881:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,739 TRACE [ABFS-prefetch-6]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 4194304 bytes 0
2022-11-08 22:53:58,740 DEBUG [ABFS-prefetch-4]: services.ReadBufferManager (ReadBufferManager.java:placeBufferOnFreeList(406)) - Returning buffer index 14 to free list for 'failed read'; owner ReadBuffer{status=READING_IN_PROGRESS, offset=0, length=0, requestedLength=4194304, bufferindex=14, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=null, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@1e698c12{counters=((read_ahead_bytes_read=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_operations=1) (stream_read_seek_backward_operations=0) (stream_read_operations=1) (bytes_read_buffer=0) (stream_read_seek_bytes_skipped=0) (remote_bytes_read=0) (stream_read_bytes=0) (seek_in_buffer=0) (action_http_get_request=0) (stream_read_seek_forward_operations=1) (remote_read_op=2) (action_http_get_request.failures=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(510233618){StreamStatistics{counters=((remote_bytes_read=0) (remote_read_op=2) (stream_read_seek_backward_operations=0) (seek_in_buffer=0) (bytes_read_buffer=0) (action_http_get_request=0) (stream_read_seek_bytes_skipped=0) (stream_read_bytes=0) (stream_read_seek_operations=1) (stream_read_seek_forward_operations=1) (stream_read_bytes_backwards_on_seek=0) (action_http_get_request.failures=0) (read_ahead_bytes_read=0) (stream_read_operations=1));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}}}
2022-11-08 22:53:58,740 TRACE [ABFS-prefetch-4]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 0 bytes 0
2022-11-08 22:53:58,740 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:waitForProcess(251)) - latch done for file /testfile6170ae9e6de4 buffer idx 14 length 0
Exception in thread "ABFS-prefetch-4" java.lang.IllegalStateException: Read completed from an operation not declared as in progress ReadBuffer{status=READING_IN_PROGRESS, offset=0, length=0, requestedLength=4194304, bufferindex=14, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=org.apache.hadoop.fs.PathIOException: `/testfile6170ae9e6de4': Input/output error: Buffer index 14 found in buffer collection completedReadList, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@1e698c12{counters=((seek_in_buffer=0) (stream_read_operations=1) (stream_read_bytes=0) (read_ahead_bytes_read=0) (action_http_get_request=0) (bytes_read_buffer=0) (remote_read_op=2) (stream_read_seek_operations=1) (stream_read_seek_bytes_skipped=0) (remote_bytes_read=0) (stream_read_seek_backward_operations=0) (stream_read_seek_forward_operations=1) (stream_read_bytes_backwards_on_seek=0) (action_http_get_request.failures=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(510233618){StreamStatistics{counters=((stream_read_seek_operations=1) (stream_read_operations=1) (bytes_read_buffer=0) (stream_read_seek_bytes_skipped=0) (read_ahead_bytes_read=0) (stream_read_seek_backward_operations=0) (action_http_get_request.failures=0) (action_http_get_request=0) (stream_read_seek_forward_operations=1) (stream_read_bytes_backwards_on_seek=0) (seek_in_buffer=0) (remote_read_op=2) (remote_bytes_read=0) (stream_read_bytes=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}}}
	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.doneReading(ReadBufferManager.java:596)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferWorker.run(ReadBufferWorker.java:89)
	at java.lang.Thread.run(Thread.java:750)
2022-11-08 22:53:58,750 DEBUG [ABFS-prefetch-6]: services.ReadBufferManager (ReadBufferManager.java:placeBufferOnFreeList(406)) - Returning buffer index 13 to free list for 'failed read'; owner ReadBuffer{status=READING_IN_PROGRESS, offset=4194304, length=0, requestedLength=4194304, bufferindex=13, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=null, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@1e698c12{counters=((bytes_read_buffer=0) (stream_read_seek_backward_operations=0) (remote_bytes_read=0) (read_ahead_bytes_read=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_operations=1) (stream_read_seek_bytes_skipped=0) (stream_read_seek_forward_operations=1) (seek_in_buffer=0) (stream_read_seek_operations=1) (remote_read_op=2) (action_http_get_request.failures=0) (stream_read_bytes=0) (action_http_get_request=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(510233618){StreamStatistics{counters=((stream_read_seek_forward_operations=1) (read_ahead_bytes_read=0) (action_http_get_request=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_operations=1) (remote_bytes_read=0) (action_http_get_request.failures=0) (remote_read_op=2) (stream_read_seek_bytes_skipped=0) (stream_read_seek_backward_operations=0) (stream_read_seek_operations=1) (stream_read_bytes=0) (bytes_read_buffer=0) (seek_in_buffer=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}}}
2022-11-08 22:53:58,750 TRACE [ABFS-prefetch-6]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 4194304 bytes 0
2022-11-08 22:53:58,750 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,751 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
Exception in thread "ABFS-prefetch-6" java.lang.IllegalStateException: Read completed from an operation not declared as in progress ReadBuffer{status=AVAILABLE, offset=4194304, length=0, requestedLength=4194304, bufferindex=13, timeStamp=46329460, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=org.apache.hadoop.fs.PathIOException: `/testfile6170ae9e6de4': Input/output error: Buffer index 13 found in buffer collection completedReadList, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@1e698c12{counters=((stream_read_operations=1) (bytes_read_buffer=0) (stream_read_bytes=0) (stream_read_seek_bytes_skipped=0) (remote_read_op=3) (remote_bytes_read=0) (seek_in_buffer=0) (stream_read_bytes_backwards_on_seek=0) (read_ahead_bytes_read=0) (action_http_get_request=0) (stream_read_seek_operations=1) (stream_read_seek_forward_operations=1) (stream_read_seek_backward_operations=0) (action_http_get_request.failures=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(510233618){StreamStatistics{counters=((action_http_get_request=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_operations=1) (stream_read_bytes=0) (remote_bytes_read=0) (stream_read_seek_forward_operations=1) (action_http_get_request.failures=0) (stream_read_seek_backward_operations=0) (stream_read_operations=1) (read_ahead_bytes_read=0) (stream_read_seek_bytes_skipped=0) (remote_read_op=3) (seek_in_buffer=0) (bytes_read_buffer=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}}}
	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.doneReading(ReadBufferManager.java:596)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferWorker.run(ReadBufferWorker.java:89)
	at java.lang.Thread.run(Thread.java:750)
2022-11-08 22:53:58,752 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:6e9c341f-b783-4cd8-8cad-73e3b1a1126b:e06a785f-2dfd-4da4-849a-db496a220182::7cf4d583f881:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,752 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 0 length 4194304
2022-11-08 22:53:58,752 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 0 buffer idx 13
2022-11-08 22:53:58,752 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 4194304 length 4194304
2022-11-08 22:53:58,752 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 4194304 buffer idx 12
2022-11-08 22:53:58,753 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:getBlock(200)) - getBlock for file /testfile6170ae9e6de4  position 0  thread JUnit-purgeIssue
2022-11-08 22:53:58,753 TRACE [ABFS-prefetch-7]: services.ReadBufferManager (ReadBufferManager.java:getNextBlockToRead(575)) - ReadBufferWorker picked file /testfile6170ae9e6de4 for offset 0
2022-11-08 22:53:58,753 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:waitForProcess(237)) - got a relevant read buffer for file /testfile6170ae9e6de4 offset 0 buffer idx 13
2022-11-08 22:53:58,753 DEBUG [ABFS-prefetch-7]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,753 TRACE [ABFS-prefetch-0]: services.ReadBufferManager (ReadBufferManager.java:getNextBlockToRead(575)) - ReadBufferWorker picked file /testfile6170ae9e6de4 for offset 4194304
2022-11-08 22:53:58,753 DEBUG [ABFS-prefetch-7]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,754 DEBUG [ABFS-prefetch-7]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:3e9b6ea6-07d3-4b14-91ce-9d207935b809:e06a785f-2dfd-4da4-849a-db496a220182:0ad0441c-600f-4ef6-b660-9cfbe4a02290:37e68c8351bf:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,754 TRACE [ABFS-prefetch-7]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 0 bytes 0
2022-11-08 22:53:58,754 DEBUG [ABFS-prefetch-0]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,754 DEBUG [ABFS-prefetch-0]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,754 DEBUG [ABFS-prefetch-0]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:b18265ff-0f41-47b6-898a-f3a27e253391:e06a785f-2dfd-4da4-849a-db496a220182:0ad0441c-600f-4ef6-b660-9cfbe4a02290:37e68c8351bf:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,754 TRACE [ABFS-prefetch-0]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 4194304 bytes 0
2022-11-08 22:53:58,756 DEBUG [ABFS-prefetch-7]: services.ReadBufferManager (ReadBufferManager.java:placeBufferOnFreeList(406)) - Returning buffer index 13 to free list for 'failed read'; owner ReadBuffer{status=READING_IN_PROGRESS, offset=0, length=0, requestedLength=4194304, bufferindex=13, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=null, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@2942932f{counters=((remote_bytes_read=0) (stream_read_seek_bytes_skipped=0) (stream_read_seek_operations=1) (stream_read_seek_backward_operations=0) (read_ahead_bytes_read=0) (remote_read_op=2) (action_http_get_request.failures=0) (stream_read_operations=1) (bytes_read_buffer=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_forward_operations=1) (action_http_get_request=0) (stream_read_bytes=0) (seek_in_buffer=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(692228911){StreamStatistics{counters=((bytes_read_buffer=0) (stream_read_bytes=0) (action_http_get_request=0) (stream_read_seek_backward_operations=0) (remote_read_op=2) (read_ahead_bytes_read=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_forward_operations=1) (action_http_get_request.failures=0) (remote_bytes_read=0) (stream_read_operations=1) (stream_read_seek_bytes_skipped=0) (stream_read_seek_operations=1) (seek_in_buffer=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}}}
2022-11-08 22:53:58,756 TRACE [ABFS-prefetch-7]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 0 bytes 0
2022-11-08 22:53:58,756 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:waitForProcess(251)) - latch done for file /testfile6170ae9e6de4 buffer idx 13 length 0
2022-11-08 22:53:58,760 DEBUG [ABFS-prefetch-0]: services.ReadBufferManager (ReadBufferManager.java:placeBufferOnFreeList(406)) - Returning buffer index 12 to free list for 'failed read'; owner ReadBuffer{status=READING_IN_PROGRESS, offset=4194304, length=0, requestedLength=4194304, bufferindex=12, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=null, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@2942932f{counters=((stream_read_bytes=0) (bytes_read_buffer=0) (stream_read_operations=1) (stream_read_seek_forward_operations=1) (stream_read_seek_operations=1) (remote_bytes_read=0) (stream_read_seek_backward_operations=0) (action_http_get_request.failures=0) (action_http_get_request=0) (stream_read_bytes_backwards_on_seek=0) (seek_in_buffer=0) (read_ahead_bytes_read=0) (remote_read_op=2) (stream_read_seek_bytes_skipped=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(692228911){StreamStatistics{counters=((stream_read_operations=1) (remote_bytes_read=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_bytes=0) (action_http_get_request=0) (remote_read_op=2) (bytes_read_buffer=0) (seek_in_buffer=0) (action_http_get_request.failures=0) (stream_read_seek_forward_operations=1) (stream_read_seek_backward_operations=0) (stream_read_seek_operations=1) (stream_read_seek_bytes_skipped=0) (read_ahead_bytes_read=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}}}
2022-11-08 22:53:58,760 TRACE [ABFS-prefetch-0]: services.ReadBufferManager (ReadBufferManager.java:doneReading(591)) - ReadBufferWorker completed file /testfile6170ae9e6de4 for offset 4194304 bytes 0
2022-11-08 22:53:58,761 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - ReadFile
2022-11-08 22:53:58,762 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:58,762 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: ReadFile: 200,,,cid=:308180e0-9f84-49c1-b6b8-e52fd58bc856:e06a785f-2dfd-4da4-849a-db496a220182::37e68c8351bf:RE:0,rid=,sent=0,recv=0,GET,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812/testfile6170ae9e6de4?timeout=90
2022-11-08 22:53:58,763 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 0 length 4194304
Exception in thread "ABFS-prefetch-0" java.lang.IllegalStateException: Read completed from an operation not declared as in progress ReadBuffer{status=AVAILABLE, offset=4194304, length=0, requestedLength=4194304, bufferindex=12, timeStamp=46329471, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=org.apache.hadoop.fs.PathIOException: `/testfile6170ae9e6de4': Input/output error: Buffer index 12 found in buffer collection completedReadList, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@2942932f{counters=((stream_read_seek_bytes_skipped=0) (action_http_get_request=0) (stream_read_seek_operations=1) (remote_bytes_read=0) (stream_read_seek_forward_operations=1) (bytes_read_buffer=0) (stream_read_bytes=0) (action_http_get_request.failures=0) (stream_read_operations=1) (seek_in_buffer=0) (stream_read_seek_backward_operations=0) (remote_read_op=3) (read_ahead_bytes_read=0) (stream_read_bytes_backwards_on_seek=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(692228911){StreamStatistics{counters=((stream_read_operations=1) (stream_read_seek_backward_operations=0) (stream_read_bytes=0) (stream_read_seek_bytes_skipped=0) (stream_read_seek_forward_operations=2) (stream_read_seek_operations=2) (stream_read_bytes_backwards_on_seek=0) (read_ahead_bytes_read=0) (seek_in_buffer=0) (action_http_get_request=0) (bytes_read_buffer=0) (remote_read_op=3) (remote_bytes_read=0) (action_http_get_request.failures=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}}}
	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.doneReading(ReadBufferManager.java:596)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferWorker.run(ReadBufferWorker.java:89)
	at java.lang.Thread.run(Thread.java:750)
2022-11-08 22:53:58,768 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 0 buffer idx 12
2022-11-08 22:53:58,769 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(149)) - Start Queueing readAhead for /testfile6170ae9e6de4 offset 4194304 length 4194304
2022-11-08 22:53:58,769 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:queueReadAhead(175)) - Done q-ing readAhead for file /testfile6170ae9e6de4 offset 4194304 buffer idx 11
2022-11-08 22:53:58,769 TRACE [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:getBlock(200)) - getBlock for file /testfile6170ae9e6de4  position 0  thread JUnit-purgeIssue
Exception in thread "ABFS-prefetch-7" java.lang.IllegalStateException: Read completed from an operation not declared as in progress ReadBuffer{status=READING_IN_PROGRESS, offset=0, length=0, requestedLength=4194304, bufferindex=13, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=org.apache.hadoop.fs.PathIOException: `/testfile6170ae9e6de4': Input/output error: Buffer index 13 found in buffer collection completedReadList, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@2942932f{counters=((action_http_get_request=0) (read_ahead_bytes_read=0) (stream_read_seek_forward_operations=2) (seek_in_buffer=0) (remote_bytes_read=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_bytes_skipped=0) (remote_read_op=3) (action_http_get_request.failures=0) (stream_read_bytes=0) (stream_read_seek_backward_operations=0) (stream_read_operations=1) (stream_read_seek_operations=2) (bytes_read_buffer=0));
gauges=();
minimums=((action_http_get_request.min=-1) (action_http_get_request.failures.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(692228911){StreamStatistics{counters=((stream_read_seek_forward_operations=2) (remote_bytes_read=0) (action_http_get_request.failures=0) (stream_read_seek_bytes_skipped=0) (read_ahead_bytes_read=0) (stream_read_seek_operations=2) (stream_read_seek_backward_operations=0) (stream_read_bytes=0) (action_http_get_request=0) (seek_in_buffer=0) (bytes_read_buffer=0) (stream_read_bytes_backwards_on_seek=0) (remote_read_op=3) (stream_read_operations=1));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}}}
	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.doneReading(ReadBufferManager.java:596)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferWorker.run(ReadBufferWorker.java:89)
	at java.lang.Thread.run(Thread.java:750)
2022-11-08 22:53:58,773 DEBUG [JUnit-purgeIssue]: services.ReadBufferManager (ReadBufferManager.java:placeBufferOnFreeList(406)) - Returning buffer index 12 to free list for 'clear from readahead'; owner ReadBuffer{status=NOT_AVAILABLE, offset=0, length=0, requestedLength=4194304, bufferindex=12, timeStamp=0, isFirstByteConsumed=false, isLastByteConsumed=false, isAnyByteConsumed=false, errException=null, stream=org.apache.hadoop.fs.azurebfs.services.AbfsInputStream@1e8d14ef{counters=((stream_read_seek_operations=1) (remote_read_op=0) (read_ahead_bytes_read=0) (stream_read_bytes=0) (remote_bytes_read=0) (stream_read_seek_forward_operations=1) (stream_read_operations=1) (stream_read_bytes_backwards_on_seek=0) (seek_in_buffer=0) (action_http_get_request=0) (stream_read_seek_bytes_skipped=0) (stream_read_seek_backward_operations=0) (action_http_get_request.failures=0) (bytes_read_buffer=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.failures.max=-1) (action_http_get_request.max=-1));
means=((action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)));
}AbfsInputStream@(512562415){StreamStatistics{counters=((action_http_get_request.failures=0) (stream_read_bytes=0) (remote_read_op=0) (seek_in_buffer=0) (action_http_get_request=0) (stream_read_operations=1) (read_ahead_bytes_read=0) (remote_bytes_read=0) (stream_read_seek_operations=1) (bytes_read_buffer=0) (stream_read_seek_bytes_skipped=0) (stream_read_bytes_backwards_on_seek=0) (stream_read_seek_forward_operations=1) (stream_read_seek_backward_operations=0));
gauges=();
minimums=((action_http_get_request.failures.min=-1) (action_http_get_request.min=-1));
maximums=((action_http_get_request.max=-1) (action_http_get_request.failures.max=-1));
means=((action_http_get_request.failures.mean=(samples=0, sum=0, mean=0.0000)) (action_http_get_request.mean=(samples=0, sum=0, mean=0.0000)));
}}}
2022-11-08 22:53:58,773 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - DeleteFileSystem
2022-11-08 22:53:58,774 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:59,031 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: DeleteFileSystem: 202,,,cid=:b9af667d-a36b-449a-aca1-789c3f9b323f:e06a785f-2dfd-4da4-849a-db496a220182:::TS:0,rid=3d6cd3eb-a01f-00ca-3108-f45105000000,sent=0,recv=0,DELETE,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812?resource=filesystem&timeout=90
2022-11-08 22:53:59,036 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:completeExecute(224)) - First execution of REST operation - GetFileSystemProperties
2022-11-08 22:53:59,036 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(262)) - Authenticating request with OAuth2 access token
2022-11-08 22:53:59,290 DEBUG [JUnit-purgeIssue]: services.AbfsClient (AbfsRestOperation.java:executeHttpOperation(344)) - HttpRequest: GetFileSystemProperties: 404,,,cid=:e6b6f851-a292-45f1-83c4-846740071ca0:e06a785f-2dfd-4da4-849a-db496a220182:::TS:0,rid=3d6cd415-a01f-00ca-5b08-f45105000000,sent=0,recv=0,HEAD,https://pranavsaxenahns.dfs.core.windows.net/abfs-testcontainer-21d833e2-076a-409c-a03d-0be6ff7dc812?resource=filesystem&timeout=90
2022-11-08 22:53:59,314 DEBUG [JUnit-purgeIssue]: services.AbfsClient (HadoopExecutors.java:shutdown(118)) - Gracefully shutting down executor service org.apache.hadoop.thirdparty.com.google.common.util.concurrent.MoreExecutors$ScheduledListeningDecorator@7bbae745. Waiting max 0 SECONDS
2022-11-08 22:53:59,314 DEBUG [JUnit-purgeIssue]: services.AbfsClient (HadoopExecutors.java:shutdown(128)) - Succesfully shutdown executor service

java.lang.IllegalStateException: Buffer index 12 found in buffer collection completedReadList

	at org.apache.hadoop.util.Preconditions.checkState(Preconditions.java:298)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.verifyByteBufferNotInCollection(ReadBufferManager.java:470)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.verifyByteBufferNotInUse(ReadBufferManager.java:456)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.placeBufferOnFreeList(ReadBufferManager.java:412)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.clearFromReadAheadQueue(ReadBufferManager.java:395)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.waitForProcess(ReadBufferManager.java:231)
	at org.apache.hadoop.fs.azurebfs.services.ReadBufferManager.getBlock(ReadBufferManager.java:204)
	at org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.readInternal(AbfsInputStream.java:505)
	at org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.readOneBlock(AbfsInputStream.java:324)
	at org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.read(AbfsInputStream.java:270)
	at org.apache.hadoop.fs.FSInputStream.read(FSInputStream.java:78)
	at org.apache.hadoop.fs.azurebfs.services.AbfsInputStream.read(AbfsInputStream.java:194)
	at org.apache.hadoop.fs.FSDataInputStream.read(FSDataInputStream.java:100)
	at org.apache.hadoop.fs.azurebfs.ITestPartialRead.purgeIssue(ITestPartialRead.java:138)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:299)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:293)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:750)


Process finished with exit code 255
